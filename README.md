# Projeto Multi-Agente Calculadora

Um projeto Python abrangente com calculadora, interface CLI, gera√ß√£o automatizada de testes usando agentes de IA e ferramentas de an√°lise de qualidade.

## üìã √çndice

- [Estrutura do Projeto](#estrutura-do-projeto)
- [In√≠cio R√°pido](#in√≠cio-r√°pido)
- [Configura√ß√£o e Instala√ß√£o](#configura√ß√£o-e-instala√ß√£o)
- [Uso da Calculadora](#uso-da-calculadora)
- [GeniusTest - Gerador de Testes com IA](#geniustest---gerador-de-testes-com-ia)
- [Benchmark - An√°lise de Qualidade](#benchmark---an√°lise-de-qualidade)
- [Fluxo de Desenvolvimento](#fluxo-de-desenvolvimento)
- [Configura√ß√£o](#configura√ß√£o)
- [Solu√ß√£o de Problemas](#solu√ß√£o-de-problemas)

## üèóÔ∏è Estrutura do Projeto

```
multi_agents/
‚îú‚îÄ‚îÄ calculator/                 # Projeto principal da calculadora
‚îÇ   ‚îú‚îÄ‚îÄ src/calculator/        # C√≥digo fonte
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ calculator.py      # L√≥gica principal da calculadora
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cli.py            # Interface de linha de comando
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py           # Ponto de entrada da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ tests/                # Arquivos de teste
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_calculator.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_cli.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_main.py
‚îÇ   ‚îî‚îÄ‚îÄ pyproject.toml        # Depend√™ncias do projeto
‚îú‚îÄ‚îÄ geniustest.py             # Gerador de testes com IA
‚îú‚îÄ‚îÄ benchmark.py              # Analisador de qualidade e cobertura
‚îú‚îÄ‚îÄ .env                      # Vari√°veis de ambiente
‚îî‚îÄ‚îÄ README.md                 # Este arquivo
```

## üöÄ In√≠cio R√°pido

1. **Clone e configura√ß√£o:**
```bash
git clone <seu-repositorio>
cd multi_agents
```

2. **Configurar ambiente:**
```bash
uv sync
echo "GOOGLE_API_KEY=sua_chave_api_aqui" > .env
```

3. **Executar calculadora:**
```bash
cd calculator
uv run calc add 5 3
```

4. **Gerar testes:**
```bash
uv run python ../geniustest.py --directory ./calculator/src --write-files
```

5. **Executar benchmark:**
```bash
cd calculator
uv run python ../benchmark.py
```

## üõ†Ô∏è Configura√ß√£o e Instala√ß√£o

### Pr√©-requisitos

- Python 3.12+
- Gerenciador de pacotes [uv](https://docs.astral.sh/uv/)
- Chave API do Google Gemini

### Passos de Instala√ß√£o

1. **Instalar uv** (se ainda n√£o instalado):
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

2. **Inicializar o projeto:**
```bash
cd multi_agents
uv sync
```

3. **Configurar vari√°veis de ambiente:**
```bash
# Criar arquivo .env com sua chave API do Google
echo "GOOGLE_API_KEY=sua_chave_api_real_aqui" > .env
```

4. **Instalar calculadora como pacote:**
```bash
cd calculator
uv pip install -e .
```

5. **Verificar instala√ß√£o:**
```bash
uv run calc --help
```

## üßÆ Uso da Calculadora

A calculadora fornece uma interface CLI para opera√ß√µes matem√°ticas com rastreamento de hist√≥rico.

### Opera√ß√µes B√°sicas

```bash
cd calculator

# Adi√ß√£o
uv run calc add 5 3
# Resultado: 8.0

# Subtra√ß√£o
uv run calc subtract 10 4
# Resultado: 6.0

# Multiplica√ß√£o
uv run calc multiply 6 7
# Resultado: 42.0

# Divis√£o
uv run calc divide 15 3
# Resultado: 5.0

# Potencia√ß√£o
uv run calc power 2 8
# Resultado: 256.0
```

### Recursos Avan√ßados

**Trabalhando com n√∫meros negativos:**
```bash
# Use -- para separar n√∫meros negativos das op√ß√µes
uv run calc add -- -5 -3
# Resultado: -8.0

uv run calc subtract -- 5 -3
# Resultado: 8.0
```

**Gerenciamento de hist√≥rico:**
```bash
# Ver hist√≥rico de c√°lculos
uv run calc history

# Limpar hist√≥rico
uv run calc clear
```

### Uso da API Python

```python
from calculator.calculator import Calculator

calc = Calculator()
result = calc.add(5, 3)
print(f"Resultado: {result}")
print(f"Hist√≥rico: {calc.get_history()}")
```

## ü§ñ GeniusTest - Gerador de Testes com IA

GeniusTest √© um sistema multi-agente que gera automaticamente testes unit√°rios abrangentes para c√≥digo Python usando IA.

### Funcionalidades

- **An√°lise multi-agente**: Analisador de c√≥digo, gerador de testes, especialista em padr√µes, avaliador de qualidade
- **Testes funcionais reais**: Gera testes execut√°veis, n√£o apenas exemplos
- **Cobertura abrangente**: Testa casos de sucesso, erros e casos extremos
- **M√∫ltiplos formatos de sa√≠da**: Exibi√ß√£o no console ou gera√ß√£o de arquivos

### Exemplos de Uso

**Analisar e exibir testes para um √∫nico arquivo:**
```bash
uv run python geniustest.py --file ./calculator/src/calculator/calculator.py
```

**Gerar arquivos de teste para diret√≥rio inteiro:**
```bash
uv run python geniustest.py --directory ./calculator/src --write-files --output ./calculator/tests_generated
```

**Processar com diret√≥rio de sa√≠da personalizado:**
```bash
uv run python geniustest.py --directory ./meu_projeto --write-files --output ./meus_testes
```

**Executar com c√≥digo de exemplo:**
```bash
uv run python geniustest.py
```

### Op√ß√µes da Linha de Comando

```bash
uv run python geniustest.py --help

Op√ß√µes:
  -d, --directory TEXT    Caminho do diret√≥rio para escanear arquivos Python
  -f, --file TEXT        Arquivo Python √∫nico para processar
  -o, --output TEXT      Diret√≥rio de sa√≠da para arquivos de teste gerados (padr√£o: tests)
  -w, --write-files      Escrever testes gerados em arquivos
  --example              Executar com c√≥digo de exemplo
```

### Estrutura dos Testes Gerados

GeniusTest gera testes seguindo esta estrutura:

```python
import unittest
import sys
import os

# Configura√ß√£o de caminho para imports
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from calculator.calculator import Calculator

class TestCalculator(unittest.TestCase):
    
    def setUp(self):
        self.calculator = Calculator()
    
    def test_add_positive_numbers(self):
        result = self.calculator.add(5, 3)
        self.assertEqual(result, 8)
    
    def test_add_negative_numbers(self):
        result = self.calculator.add(-5, -3)
        self.assertEqual(result, -8)
    
    def test_divide_by_zero(self):
        with self.assertRaises(ValueError):
            self.calculator.divide(5, 0)

if __name__ == '__main__':
    unittest.main()
```

## üìä Benchmark - An√°lise de Qualidade

O script de benchmark fornece an√°lise abrangente de cobertura de testes e m√©tricas de qualidade.

### Funcionalidades

- **An√°lise de Cobertura**: Cobertura de linha e branch usando pytest-cov
- **M√©tricas de Qualidade de Testes**: Densidade de testes, qualidade de assertions, melhores pr√°ticas
- **Pontua√ß√£o de Qualidade**: Pontua√ß√£o geral (0-100) com notas por letras
- **M√∫ltiplos Formatos de Sa√≠da**: Relat√≥rios em texto e dados JSON

### Exemplos de Uso

**An√°lise b√°sica de benchmark:**
```bash
cd calculator
uv run python ../benchmark.py
```

**Gerar arquivo de relat√≥rio:**
```bash
cd calculator
uv run python ../benchmark.py --output relatorio_benchmark.txt
```

**Sa√≠da JSON para CI/CD:**
```bash
cd calculator
uv run python ../benchmark.py --json --output resultados.json
```

**Caminhos de projeto personalizados:**
```bash
uv run python benchmark.py --project ./meu_projeto --tests meus_testes --source meu_src
```

### Op√ß√µes da Linha de Comando

```bash
uv run python benchmark.py --help

Op√ß√µes:
  -p, --project TEXT     Caminho do diret√≥rio do projeto (padr√£o: .)
  -t, --tests TEXT       Caminho do diret√≥rio de testes (padr√£o: tests)
  -s, --source TEXT      Diret√≥rio do c√≥digo fonte (padr√£o: src)
  -o, --output TEXT      Arquivo de relat√≥rio de sa√≠da
  --json                 Gerar resultados em formato JSON
```

### Exemplo de Relat√≥rio de Benchmark

```
# Relat√≥rio de Benchmark de Qualidade e Cobertura de Testes
Gerado em: 2025-08-13 22:15:23
Projeto: calculator

## Pontua√ß√£o Geral de Qualidade: 85.42/100 (Nota: B)

### An√°lise de Cobertura
- Cobertura de Linha: 94.94%
- Cobertura de Branch: 87.50%
- Pontua√ß√£o de Cobertura: 94.94/100

### M√©tricas de Qualidade de Testes
- Total de Arquivos de Teste: 3
- Total de M√©todos de Teste: 44
- Total de Assertions: 92
- M√©dia de Assertions por Teste: 2.09
- M√©todos Setup/Teardown: 3
- Uso de Mock: 8
- Testes Parametrizados: 0

### Detalhamento das Pontua√ß√µes de Qualidade
- Pontua√ß√£o de Densidade de Testes: 100/100
- Pontua√ß√£o de Qualidade de Assertions: 41.82/100
- Pontua√ß√£o de Melhores Pr√°ticas: 59.09/100

### Cobertura Arquivo por Arquivo
- calculator.py: 100.0% linhas
- cli.py: 97.7% linhas
- main.py: 0.0% linhas

‚úÖ An√°lise de cobertura conclu√≠da com sucesso
```

## üîß Fluxo de Desenvolvimento

### Executando Testes

```bash
cd calculator

# Executar todos os testes
uv run pytest

# Executar com cobertura
uv run pytest --cov=src/calculator --cov-report=html

# Executar arquivo de teste espec√≠fico
uv run pytest tests/test_calculator.py

# Executar com sa√≠da verbosa
uv run pytest -v
```

### Verifica√ß√µes de Qualidade de C√≥digo

```bash
cd calculator

# Executar an√°lise de benchmark
uv run python ../benchmark.py

# Gerar relat√≥rio de cobertura
uv run pytest --cov=src/calculator --cov-report=html
open htmlcov/index.html  # Visualizar no navegador
```

### Integra√ß√£o Cont√≠nua

Exemplo de workflow do GitHub Actions:

```yaml
name: CI
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: astral-sh/setup-uv@v1
    
    - name: Instalar depend√™ncias
      run: uv sync
      
    - name: Executar testes
      run: |
        cd calculator
        uv run pytest --cov=src/calculator --cov-report=xml
        
    - name: Executar benchmark
      run: |
        cd calculator  
        uv run python ../benchmark.py --json --output benchmark.json
```

## ‚öôÔ∏è Configura√ß√£o

### Vari√°veis de Ambiente

Criar um arquivo `.env` na raiz do projeto:

```env
# Necess√°rio para recursos de IA do GeniusTest
GOOGLE_API_KEY=sua_chave_api_google_aqui

# Opcional: Configura√ß√µes de modelo personalizado
GEMINI_MODEL=gemini-2.0-flash
TEMPERATURE=0.7
```

### Configura√ß√£o do Projeto

**pyproject.toml** para calculadora:

```toml
[project]
name = "calculator"
version = "0.1.0"
dependencies = [
    "typer>=0.9.0",
]

[tool.pytest.ini_options]
testpaths = ["tests"]
addopts = "--cov=src/calculator --cov-report=term-missing"
```

### Configura√ß√£o da IDE

**VS Code settings.json:**

```json
{
    "python.defaultInterpreterPath": ".venv/bin/python",
    "python.testing.pytestEnabled": true,
    "python.testing.pytestArgs": ["tests"],
    "python.linting.enabled": true
}
```

## üêõ Solu√ß√£o de Problemas

### Problemas Comuns

**1. Erros de "M√≥dulo n√£o encontrado":**
```bash
# Certifique-se de usar uv run
uv run pytest

# Ou ative o ambiente virtual
source .venv/bin/activate
pytest
```

**2. N√∫meros negativos tratados como op√ß√µes:**
```bash
# Use separador --
uv run calc add -- -5 -3

# Ou coloque os n√∫meros entre aspas
uv run calc add "-5" "-3"
```

**3. Cobertura n√£o coletando dados:**
```bash
# Certifique-se de usar uv run
cd calculator
uv run pytest --cov=src/calculator

# Verifique se os testes est√£o realmente importando o c√≥digo
uv run pytest -v
```

**4. Erros de API do GeniusTest:**
```bash
# Verifique se a chave API est√° definida
echo $GOOGLE_API_KEY

# Verifique se o arquivo .env existe
cat .env
```

**5. Erros de import nos testes gerados:**
- Testes gerados incluem configura√ß√£o adequada de caminho
- Certifique-se de que a estrutura do c√≥digo fonte corresponde aos imports
- Execute testes com `uv run pytest`

### Obtendo Ajuda

1. **Verificar logs**: A maioria dos comandos fornece sa√≠da verbosa com flag `-v`
2. **Validar ambiente**: Execute `uv run python -c "import calculator; print('OK')"`
3. **Testar conectividade**: Execute GeniusTest com c√≥digo de exemplo primeiro
4. **Verificar depend√™ncias**: Execute `uv sync` para garantir que todos os pacotes est√£o instalados

### Dicas de Performance

- **Use `--write-files`** com GeniusTest para projetos grandes para evitar spam no console
- **Execute benchmark periodicamente** para acompanhar melhorias de qualidade
- **Use sa√≠da JSON** para processamento automatizado em CI/CD
- **Cache do ambiente virtual** em sistemas CI para builds mais r√°pidos

## üìö Recursos Adicionais

- [Documenta√ß√£o do uv](https://docs.astral.sh/uv/)
- [Documenta√ß√£o do pytest](https://docs.pytest.org/)
- [Documenta√ß√£o do Typer](https://typer.tiangolo.com/)
- [API do Google Gemini](https://ai.google.dev/docs)

---

## ü§ù Contribuindo

1. Fa√ßa fork do reposit√≥rio
2. Crie uma branch de feature: `git checkout -b nome-da-feature`
3. Fa√ßa mudan√ßas e adicione testes
4. Execute verifica√ß√µes de qualidade: `uv run python benchmark.py`
5. Submeta um pull request

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a Licen√ßa MIT. Veja o arquivo LICENSE para detalhes.